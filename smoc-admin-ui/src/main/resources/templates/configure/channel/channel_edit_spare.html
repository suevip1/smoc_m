<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:mpm="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <th:block th:insert="fragments/common_fragments :: common_header"/>
    <th:block th:insert="fragments/common_fragments :: common_css"/>
    <th:block th:insert="fragments/common_fragments :: select_css"/>
</head>
<body style="background-color:#fff">
<!-- Loader start 页面加载进度-->
<th:block th:insert="fragments/common_fragments :: common_loader"/>
<!-- Loader end -->

<!-- Start content -->
<div class="content">
    <div class="container">

        <!-- start row  页面内容-->
        <div class="row" th:remove="${#strings.isEmpty(error)}?none:all" style="background-color:#fff">
            <div class="col-md-12">
                <form id="submit_form" th:action="@{/configure/channel/spare/save/{op}(op=${op})}" th:object="${configChannelSpareChannelValidator}"
                      method="post" data-parsley-validate="">
                    <div class="row">
                        <div class="col-md-12 panel panel-color panel-brown" style="padding-left:0px;padding-right:0px">
                            <div class="panel-heading">
                                <h3 class="panel-title">失败补发通道配置</h3>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-sm-4 m-b-10">
                                                    <label>补发通道<span class="text-danger">*</span><span
                                                            class="text-danger"
                                                            style="font-weight: 200;font-size: 12px"></span>
                                                    </label>
                                                    <select data-style="btn-default" name="spareChannelId" data-live-search="true"
                                                            id="spareChannelId" class="selectpicker form-control">
                                                        <option value="" data-icon="mdi mdi-view-module">--请选择失败补发通道--
                                                        </option>
                                                        <option data-icon="mdi mdi-account" th:each="channel:${channelList}"
                                                                th:selected="${configChannelSpareChannelValidator.spareChannelId eq channel.channelId}"
                                                                th:value="${channel.channelId}">[[${channel.spareChannelName}]]
                                                        </option>
                                                    </select>
                                                </div>
                                                <div class="col-sm-4 m-b-10">
                                                    <label>状态码失败补发<span class="text-danger">*</span><span
                                                            class="text-danger"
                                                            style="font-weight: 200;font-size: 12px"></span>
                                                    </label>
                                                    <input type="text" required="" th:field="*{statusFailureSupple}" placeholder="状态码失败补发"
                                                           data-parsley-length="[1,90]" class="form-control" autocomplete="off">
                                                </div>
                                                <div class="col-sm-4 m-b-10">
                                                    <label>账号失败补发<span
                                                            class="text-danger"
                                                            style="font-weight: 200;font-size: 12px"></span>
                                                    </label>
                                                    <input type="text" th:field="*{accountFailureSupple}" placeholder="账号失败补发"
                                                           data-parsley-length="[1,90]" class="form-control" autocomplete="off">
                                                </div>
                                                <div class="col-sm-4 m-b-10" style="padding-left: 10px;">
                                                    <label>内容失败补发</label>
                                                    <input type="text" th:field="*{contentFailureSupple}" placeholder="内容失败补发"
                                                           data-parsley-length="[1,90]" class="form-control" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="text-center" style="margin-bottom:20px;margin-top:20px">
                                                <input type="hidden" th:field="*{createdTime}">
                                                <input type="hidden" th:field="*{createdBy}">
                                                <input type="hidden" th:field="*{id}">
                                                <input type="hidden" th:field="*{channelId}">
                                                <button type="submit" sec:authorize-url="/configure/channel/spare/save/*" class="btn btn-teal waves-effect waves-light">提交</button>
                                                <a data-toggle="modal"
                                                   data-target="#user-forbiden"
                                                   sec:authorize-url="/configure/channel/spare/resetSpareChannel/*"
                                                   th:onclick="resetSpare([[${configChannelSpareChannelValidator.id}]])"
                                                   class="btn btn-default waves-effect waves-light">重置为空</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- end col -->
                    </div> <!-- end row -->
                </form>
                <!-- end form -->
            </div>
        </div>
        <!-- end row -->

        <!-- start row  错误提示-->
        <th:block th:insert="fragments/common_fragments :: common_error"/>
        <!-- end row -->

    </div> <!-- container -->
</div> <!-- content -->
<!-- start confirm user-forbiden modal  -->
<div id="user-forbiden" class="modal fade" tabindex="-1" role="dialog" th:remove="${#strings.isEmpty(error)}?none:all"
     aria-labelledby="custom-width-modalLabel" aria-hidden="true" style="display: none;margin-top: 80px">
    <div class="modal-dialog" style="width:33%;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">重置备用通道</h4>
            </div>
            <div class="modal-body">
                <h4>注意：</h4>
                <p>重置备用通道为空之后，原通道失败之后不会进行补发！</p>
            </div>
            <div class="modal-footer">
                <input type="hidden" id="apareId">
                <button type="button" id="forbbenButton" sec:authorize-url="/configure/channel/spare/resetSpareChannel/*"
                        onclick="confirmSapre()" class="btn btn-danger waves-effect waves-light">重置为空
                </button>
                <button type="button" class="btn btn-default waves-effect" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
<!-- end confirm user-forbiden modal  -->
<th:block th:insert="fragments/common_fragments :: common_js"/>
<th:block th:insert="fragments/common_fragments :: select_js"/>
<th:block th:insert="fragments/common_fragments :: common_submit_form"/>
<script>

    function resetSpare(id) {
        $("#apareId").val(id);
    }

    function confirmSapre() {
        var contextPath = '[[${#httpServletRequest.getContextPath()}]]';
        $('#preloader').css('display', 'block');
        location.href = contextPath + '/configure/channel/spare/resetSpareChannel/' + $("#apareId").val() ;
    }

    var resizefunc = [];
    //隐藏进度项
    $('#preloader').css('display', 'none');

</script>
</body>
</html>